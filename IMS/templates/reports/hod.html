{% extends 'base/base.html' %}
{% load static %}

{% block content %}

<div class="min-h-screen">

	<!-- Welcome -->
	<h1 class="text-2xl font-bold mb-10 text-center text-blue-800 drop-shadow-sm"> {{ welcome_message|safe }} </h1>

	<!-- Summary Cards -->
	<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
		<div id="cardStaffDetails"
			class="p-6 bg-white border-t-4 border-blue-500 rounded-2xl shadow hover:shadow-lg transition text-center">
			<h2 class="text-md font-semibold text-gray-500 uppercase">Total Staff</h2>
			<p class="text-3xl font-extrabold text-blue-700 mt-2">{{ total_staff }}</p>
		</div>
		<div id="cardHallDetails"
			class="p-6 bg-white border-t-4 border-green-500 rounded-2xl shadow hover:shadow-lg transition text-center">
			<h2 class="text-md font-semibold text-gray-500 uppercase">Total Halls</h2>
			<p class="text-3xl font-extrabold text-green-700 mt-2">{{ total_halls }}</p>
		</div>
		<div id="cardHallSchedule"
			class="p-6 bg-white border-t-4 border-yellow-500 rounded-2xl shadow hover:shadow-lg transition text-center">
			<h2 class="text-md font-semibold text-gray-500 uppercase">Sessions Scheduled</h2>
			<p class="text-3xl font-extrabold text-yellow-600 mt-2">{{ total_sessions }}</p>
		</div>
	</div>

	<!-- Global Search -->
	<div class="flex justify-center mb-10">
		<input type="text" id="globalSearchInput" placeholder="🔍 Search all tables..."
			class="border border-gray-300 rounded-l-lg px-4 py-2 w-80 focus:outline-none shadow-sm" />
		<button id="globalSearchBtn"
			class="px-4 py-2 bg-blue-600 text-white rounded-r-lg shadow hover:bg-blue-700 transition">
			Search
		</button>
	</div>

	<!-- Toggle Buttons -->
	<div class="flex justify-between mb-6">
		<button data-target="instructions"
			class="tab-btn px-5 py-2.5 rounded-lg bg-white border border-gray-200 text-gray-700 font-semibold shadow hover:bg-blue-50 hover:text-blue-700 transition">
			Instructions
		</button>
		<button data-target="mySchedule"
			class="tab-btn px-5 py-2.5 rounded-lg bg-white border border-gray-200 text-gray-700 font-semibold shadow hover:bg-blue-50 hover:text-blue-700 transition">
			My Schedule
		</button>
		<button data-target="staffDetails"
			class="tab-btn px-5 py-2.5 rounded-lg bg-white border border-gray-200 text-gray-700 font-semibold shadow hover:bg-blue-50 hover:text-blue-700 transition">
			Staff Details
		</button>
		<button data-target="staffSchedule"
			class="tab-btn px-5 py-2.5 rounded-lg bg-white border border-gray-200 text-gray-700 font-semibold shadow hover:bg-blue-50 hover:text-blue-700 transition">
			Staff Schedule
		</button>
		<button data-target="hallDetails"
			class="tab-btn px-5 py-2.5 rounded-lg bg-white border border-gray-200 text-gray-700 font-semibold shadow hover:bg-blue-50 hover:text-blue-700 transition">
			Hall Details
		</button>
		<button data-target="hallSchedule"
			class="tab-btn px-5 py-2.5 rounded-lg bg-white border border-gray-200 text-gray-700 font-semibold shadow hover:bg-blue-50 hover:text-blue-700 transition">
			Hall Schedule
		</button>
	</div>

	<!-- 🔹 Active Tab Name Display -->
	<div id="activeTabDisplay" class="text-center text-lg font-semibold text-blue-700">
		Currently Viewing : Instructions
	</div>

	<!-- Tables -->
	<div class="space-y-6">
		<!-- Instructions -->
		<div id="instructions" class="table-container hidden mt-6">
			<div class="text-md 2xl:text-xl bg-yellow-50 border-l-4 border-yellow-400 p-8 text-gray-800 rounded-xl shadow">
				<ul class="list-disc pl-6 space-y-3 text-gray-700">
					<li><b class="text-yellow-800">My Schedule :</b> View your personal duty schedule.</li>
					<li><b class="text-yellow-800">Staff Details :</b> Information about department staff members.</li>
					<li><b class="text-yellow-800">Staff Schedule :</b> Invigilation schedules of staff across
						departments.</li>
					<li><b class="text-yellow-800">Hall Details :</b> Halls scheduled for CIA tests in the department.
					</li>
					<li><b class="text-yellow-800">Hall Schedule :</b> Invigilation schedule of staff allotted to your
						halls.</li>
				</ul>
			</div>
		</div>
		<!-- My Schedule -->
		<div id="mySchedule" class="table-container hidden">
			<div class="overflow-x-auto rounded-xl shadow">
				<table class="w-full border-collapse bg-white text-sm text-center">
					<thead class="bg-blue-100 text-blue-900 font-semibold uppercase text-sm 2xl:text-lg tracking-wide">
						<tr>
							<th class="px-4 py-3">S.no</th>
							<th class="px-4 py-3">Date</th>
							<th class="px-4 py-3">Session</th>
							<th class="px-4 py-3">Hall No</th>
							<th class="px-4 py-3">Hall Department</th>
						</tr>
					</thead>
					<tbody class="divide-y divide-gray-200">
						{% for sched in my_schedule %}
						<tr class="hover:bg-gray-50 transition">
							<td class="px-4 py-2">{{ forloop.counter }}</td>
							<td class="px-4 py-2">{{ sched.date }}</td>
							<td class="px-4 py-2">{{ sched.session }}</td>
							<td class="px-4 py-2">{{ sched.hall_no }}</td>
							<td class="px-4 py-2">{{ sched.hall_department }}</td>
						</tr>
						{% empty %}
						<tr>
							<td colspan="5" class="py-4 text-gray-500">No schedule found</td>
						</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
		<!-- My Schedule -->
		<div id="staffSchedule" class="table-container hidden">
			<div class="overflow-x-auto rounded-xl shadow-lg mb-10">
				<table class="w-full border-collapse bg-white text-sm 2xl:text-lg text-left">
					<thead
						class="bg-gradient-to-r from-pink-100 to-pink-200 text-gray-800 uppercase text-sm 2xl:text-lg font-semibold tracking-wider">
						<tr>
							<th class="px-6 py-3 text-center">S.no</th>
							<th class="px-6 py-3 text-center">Staff Name</th>
							<th class="px-6 py-3 text-center">Date</th>
							<th class="px-6 py-3 text-center">Session</th>
							<th class="px-6 py-3 text-center">Hall No</th>
							<th class="px-6 py-3 text-center">Department</th>
							<th class="px-6 py-3 text-center">Mobile No</th>
						</tr>
					</thead>
					<tbody class="divide-y divide-gray-200">
						{% for schedule in staff_schedule %}
						<tr class="hover:bg-gray-50 text-center">
							<td class="px-6 py-3">{{ forloop.counter }}</td>
							<td class="px-6 py-3">{{ schedule.staff_name }}</td>
							<td class="px-6 py-3">{{ schedule.date }}</td>
							<td class="px-6 py-3">{{ schedule.session }}</td>
							<td class="px-6 py-3">{{ schedule.hall_no }}</td>
							<td class="px-6 py-3">{{ schedule.hall_department }}</td>
							<td class="px-6 py-3">{{ schedule.staff_mobile }}</td>
						</tr>
						{% empty %}
						<tr>
							<td colspan="7" class="px-6 py-4 text-center text-gray-500">No staff schedules found</td>
						</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
		<!-- My Schedule -->
		<div id="staffDetails" class="table-container hidden">
			<!-- Staff Details Table -->
			<div class="overflow-x-auto rounded-xl shadow-lg mb-10">
				<table class="w-full border-collapse bg-white text-sm 2xl:text-lg text-left">
					<thead
						class="bg-gradient-to-r from-green-100 to-green-200 text-gray-800 uppercase text-sm 2xl:text-lg font-semibold tracking-wider">
						<tr>
							<th class="px-6 py-3 text-center">S.no</th>
							<th class="px-6 py-3 text-center">Staff ID</th>
							<th class="px-6 py-3 text-center">Staff Name</th>
							<th class="px-6 py-3 text-center">DOJ</th>
							<th class="px-6 py-3 text-center">Mobile No</th>
						</tr>
					</thead>
					<tbody class="divide-y divide-gray-200">
						{% for staff in staff_details %}
						<tr class="hover:bg-gray-50 text-center">
							<td class="px-6 py-3">{{ forloop.counter }}</td>
							<td class="px-6 py-3">{{ staff.staff_id }}</td>
							<td class="px-6 py-3">{{ staff.name }}</td>
							<td class="px-6 py-3">{{ staff.date_of_joining }}</td>
							<td class="px-6 py-3">{{ staff.mobile }}</td>
						</tr>
						{% empty %}
						<tr>
							<td colspan="5" class="px-6 py-4 text-center text-gray-500">No staff found</td>
						</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
		<!-- My Schedule -->
		<div id="hallDetails" class="table-container hidden">
			<!-- Hall Details Table -->
			<div class="overflow-x-auto rounded-xl shadow-lg mb-10">
				<table class="w-full border-collapse bg-white text-sm 2xl:text-lg text-left">
					<thead
						class="bg-gradient-to-r from-yellow-100 to-yellow-200 text-gray-800 uppercase text-sm 2xl:text-lg font-semibold tracking-wider">
						<tr>
							<th class="px-6 py-3 text-center">S.no</th>
							<th class="px-6 py-3 text-center">Hall No</th>
							<th class="px-6 py-3 text-center">Strength</th>
							<th class="px-6 py-3 text-center">Staff per Session</th>
						</tr>
					</thead>
					<tbody class="divide-y divide-gray-200">
						{% for hall in hall_details %}
						<tr class="hover:bg-gray-50 text-center">
							<td class="px-6 py-3">{{ forloop.counter }}</td>
							<td class="px-6 py-3">{{ hall.hall_no }}</td>
							<td class="px-6 py-3">{{ hall.strength }}</td>
							<td class="px-6 py-3">{{ hall.staff_required }}</td>
						</tr>
						{% empty %}
						<tr>
							<td colspan="4" class="px-6 py-4 text-center text-gray-500">No halls found</td>
						</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
		<!-- My Schedule -->
		<div id="hallSchedule" class="table-container hidden">
			<!-- Hall Schedule Table -->
			<div class="overflow-x-auto rounded-xl shadow-lg mb-10">
				<table class="w-full border-collapse bg-white text-sm 2xl:text-lg text-left">
					<thead
						class="bg-gradient-to-r from-indigo-100 to-indigo-200 text-gray-800 uppercase text-sm 2xl:text-lg font-semibold tracking-wider">
						<tr>
							<th class="px-6 py-3 text-center">S.no</th>
							<th class="px-6 py-3 text-center">Hall No</th>
							<th class="px-6 py-3 text-center">Date</th>
							<th class="px-6 py-3 text-center">Session</th>
							<th class="px-6 py-3 text-center">Staff Name</th>
							<th class="px-6 py-3 text-center">Department</th>
							<th class="px-6 py-3 text-center">Mobile No</th>
						</tr>
					</thead>
					<tbody class="divide-y divide-gray-200">
						{% for schedule in hall_schedule %}
						<tr class="hover:bg-gray-50 text-center">
							<td class="px-6 py-3">{{ forloop.counter }}</td>
							<td class="px-6 py-3">{{ schedule.hall_no }}</td>
							<td class="px-6 py-3">{{ schedule.date }}</td>
							<td class="px-6 py-3">{{ schedule.session }}</td>
							<td class="px-6 py-3">{{ schedule.staff_name }}</td>
							<td class="px-6 py-3">{{ schedule.staff_dept }}</td>
							<td class="px-6 py-3">{{ schedule.staff_mobile }}</td>
						</tr>
						{% empty %}
						<tr>
							<td colspan="7" class="px-6 py-4 text-center text-gray-500">No hall schedules found</td>
						</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>

<script src="{% static 'js/reports_search.js' %}"></script>
<script src="{% static 'js/hod_view.js' %}"></script>

<script>
	document.addEventListener("DOMContentLoaded", () => {
		const tabButtons = document.querySelectorAll(".tab-btn");
		const tabContents = document.querySelectorAll(".table-container");
		const activeTabDisplay = document.getElementById("activeTabDisplay");
		let activeTab = null;
		function showTab(tabId) {
			tabContents.forEach(c => c.classList.add("hidden"));
			document.getElementById(tabId).classList.remove("hidden");
			tabButtons.forEach(btn => btn.classList.remove("bg-blue-100", "text-blue-700", "active"));
			const activeBtn = document.querySelector(`[data-target="${tabId}"]`);
			activeBtn.classList.add("bg-blue-100", "text-blue-700", "active");
			activeTab = tabId;
			activeTabDisplay.textContent = "Currently Viewing : " + activeBtn.innerText;
		}
		tabButtons.forEach(btn => {
			btn.addEventListener("click", () => {
				const target = btn.getAttribute("data-target");
				showTab(target);
			})
		})
		showTab("instructions");
	})
</script>

{% endblock %}